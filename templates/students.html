<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Student Dashboard | EMIS</title>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <!-- Student Dashboard CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/students.css') }}"/>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/student-exams.css') }}"/>
</head>

<body class="students-body">

  <!-- ================= HEADER ================= -->
  <header class="student-header">
    <div class="header-left">
      <i class="fa-solid fa-graduation-cap header-logo"></i>
      <span class="portal-title">EMIS Student Portal</span>
    </div>

    <div class="header-right">

      <!-- Live Clock -->
      <span id="liveClock" class="live-clock"></span>

      <!-- Notifications -->
      <button class="icon-btn" id="notifBtn" title="Notifications">
        <i class="fa-solid fa-bell"></i>
        <span class="notif-dot"></span>
      </button>

      <!-- Theme Toggle -->
      <button class="icon-btn" id="themeToggle" title="Toggle Theme">
        <i class="fa-solid fa-sun"></i>
      </button>

      <img src="{{ url_for('static', filename='images/student.jpg') }}"
           alt="Student Avatar"
           class="student-avatar"/>
    </div>
  </header>

  <!-- ================= HERO ================= -->
  <section class="hero-section fade-in">
    <div class="hero-overlay"></div>

    <div class="hero-content">
      <h1 class="animated-greeting">
        Welcome back, {{ student.full_name if student else "Student" }}!
      </h1>
      <p class="sub-text">Your academic dashboard — everything you need at a glance.</p>

      <div class="hero-actions expanded-buttons">
        <button class="btn-primary" id="openExamPortal">
          <i class="fa-solid fa-laptop-file"></i> Exam Portal
        </button>

        <button class="btn-light"><i class="fa-solid fa-book"></i> Subjects</button>
        <button class="btn-light"><i class="fa-solid fa-chart-line"></i> Results</button>
        <button class="btn-light"><i class="fa-solid fa-folder-open"></i> Past Questions</button>
        <button class="btn-light"><i class="fa-solid fa-file-circle-check"></i> Study Materials</button>
        <button class="btn-light"><i class="fa-solid fa-user-circle"></i> Profile</button>
        <button class="btn-light"><i class="fa-solid fa-id-card"></i> Student ID</button>
      </div>
    </div>
  </section>

  <!-- ================= STUDENT PROFILE CARD ================= -->
  <section class="profile-card-container fade-in">
    <div class="profile-card">

      <div class="profile-header">
        <i class="fa-solid fa-id-card profile-icon"></i>
        <h2>Student Profile</h2>
        <p>Basic information associated with your registration</p>
      </div>

      <div class="profile-grid">
        <div class="profile-item">
          <span>Full Name</span>
          <strong>{{ student.full_name }}</strong>
        </div>

        <div class="profile-item">
          <span>Admission Number</span>
          <strong>{{ student.admission_number }}</strong>
        </div>

        <div class="profile-item">
          <span>Class</span>
          <strong>{{ student.class }}</strong>
        </div>

        <div class="profile-item">
          <span>System ID</span>
          <strong>{{ student.id }}</strong>
        </div>
      </div>

    </div>
  </section>

  <!-- ================= MAIN AREA ================= -->
  <main class="content-area">

    <!-- ================= PERFORMANCE OVERVIEW ================= -->
    <section class="performance small-performance fade-in">
      <div class="section-header">
        <h2><i class="fa-solid fa-chart-pie"></i> Performance Overview</h2>
        <p class="subtitle">Track your academic progress</p>
      </div>

      <div class="stats-grid compact">
        <div class="stat-card"><span>Average Score</span><h3 id="avgScore">--%</h3></div>
        <div class="stat-card"><span>Exams Taken</span><h3 id="examCount">--</h3></div>
        <div class="stat-card"><span>Subjects Passed</span><h3 id="passedSubjects">--</h3></div>
      </div>

      <canvas id="performanceChart"></canvas>
    </section>

    <!-- ================= THREE CARD ROW ================= -->
    <section class="triple-grid fade-in">

      <!-- Recent Activity -->
      <div class="tri-card">
        <h2><i class="fa-solid fa-clock-rotate-left"></i> Recent Activity</h2>

        <div id="activityList" class="activity-list">
          <!-- Auto-populated on login -->
        </div>

      </div>

      <!-- Announcements -->
      <div class="tri-card">
        <h2><i class="fa-solid fa-bullhorn"></i> Announcements</h2>
        <ul id="announcementList" class="announcement-list"></ul>
      </div>

      <!-- Feedback -->
      <div class="tri-card">
        <h2><i class="fa-solid fa-comments"></i> Feedback</h2>

        <div class="chat-container">
          <div class="chat-messages" id="chatMessages"></div>

          <form id="feedbackForm" class="chat-input">
            <textarea id="feedbackText" placeholder="Type your message..."></textarea>
            <button type="submit" class="send-btn">
              <i class="fa-solid fa-paper-plane"></i>
            </button>
          </form>
        </div>
      </div>

    </section>

  </main>

  <!-- ================= FOOTER ================= -->
  <footer class="student-footer fade-in">
    <p>&copy; <span id="year"></span> EMIS Portal — Empowering Students for Success</p>
  </footer>

  <!-- ================= EXAM SUBJECT MODAL ================= -->
  <div class="modal-overlay" id="examModal">
    <div class="modal-box">

      <h2 class="modal-title">
        <i class="fa-solid fa-pen-to-square"></i> Start Your Exam
      </h2>

      <div class="form-group">
        <label for="subjectDropdown">Select Subject</label>
        <select id="subjectDropdown">
          <option value="">-- Select Subject --</option>
          {% for subject in subjects %}
          <option value="{{ subject }}">{{ subject }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="modal-actions">

        <button class="btn-secondary" id="refreshSubjectsBtn">
          Refresh Subjects
        </button>

        <button class="btn-primary" id="startExamBtn" disabled>
          Start Exam
        </button>

        <button class="btn-secondary" id="closeExamModal">
          Cancel
        </button>

      </div>
    </div>
  </div>

  <!-- ================= JS ================= -->
  <script src="{{ url_for('static', filename='js/student-exams.js') }}"></script>

  <!-- TODO: Add dynamic JS (Theme toggle, Clock, Animations) -->
  <script src="{{ url_for('static', filename='js/student-dashboard.js') }}"></script>

</body>
</html>
